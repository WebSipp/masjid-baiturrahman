<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Digital Masjid Baiturrahman</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e40af;
            --primary-light: #3b82f6;
            --accent: #2563eb;
            --text-dark: #1f2937;
            --text-light: #f9fafb;
            --friday-gold: #d4af37;
            --friday-cream: #fff8e1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        body.friday-mode {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
        }
        
        /* HEADER */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .date-section .hijri-date {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 4px;
        }
        
        .date-section .gregorian-date {
            font-size: 1.1rem;
            color: var(--text-dark);
            font-weight: 600;
        }
        
        .masjid-section {
            text-align: right;
        }
        
        .masjid-name {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: -0.5px;
        }
        
        .masjid-address {
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-top: 4px;
        }
        
        /* MAIN CONTAINER */
        .main-container {
            display: flex;
            flex: 1;
            padding: 20px;
            gap: 20px;
            min-height: 0;
        }
        
        .sidebar-left {
            flex: 0 0 35%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* CLOCK SECTION */
        .clock-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 32px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .digital-clock {
            font-size: 7rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
            letter-spacing: 2px;
            text-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
        }
        
        .friday-mode .digital-clock {
            color: var(--friday-gold);
        }
        
        .timezone {
            font-size: 1.5rem;
            color: var(--primary-light);
            font-weight: 600;
            margin-top: 8px;
        }
        
        /* WISDOM SECTION */
        .wisdom-section {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 32px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .wisdom-text {
            font-family: 'Amiri', serif;
            font-size: 1.4rem;
            line-height: 1.8;
            text-align: center;
            font-style: italic;
            margin-bottom: 16px;
            color: var(--text-dark);
        }
        
        .wisdom-reference {
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary);
            padding: 8px 20px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 50px;
        }
        
        /* WALLPAPER SECTION */
        .wallpaper-section {
            flex: 1;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .wallpaper-slider {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .wallpaper-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .wallpaper-slide.active {
            opacity: 1;
        }
        
        /* PRAYER SCHEDULE */
        .prayer-schedule {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            padding: 20px 0;
            flex-shrink: 0;
        }
        
        .friday-mode .prayer-schedule {
            background: linear-gradient(135deg, var(--friday-gold) 0%, #ffaa00 100%);
        }
        
        .schedule-title {
            text-align: center;
            color: white;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 16px;
            letter-spacing: 1px;
        }
        
        .prayer-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            padding: 0 20px;
        }
        
        .prayer-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 16px 8px;
            text-align: center;
            border-radius: 12px;
            transition: all 0.3s;
        }
        
        .prayer-item.active {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .prayer-name {
            font-size: 0.9rem;
            color: white;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .prayer-item.active .prayer-name {
            color: var(--primary);
        }
        
        .prayer-time {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
            letter-spacing: 1px;
        }
        
        .prayer-item.active .prayer-time {
            color: var(--primary);
        }
        
        /* MARQUEE */
        .marquee-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 0;
            overflow: hidden;
            height: 50px;
            flex-shrink: 0;
        }
        
        .marquee-track {
            position: absolute;
            white-space: nowrap;
            animation: marquee 60s linear infinite;
        }
        
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .adab-item {
            display: inline-block;
            padding: 0 50px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .adab-item i {
            margin-right: 12px;
            color: var(--primary);
        }
        
        /* FRIDAY MODE OVERLAY */
        .friday-notification {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--friday-gold);
            color: white;
            text-align: center;
            padding: 16px;
            font-weight: 700;
            font-size: 1.2rem;
            z-index: 1000;
            transform: translateY(-100%);
            transition: transform 0.5s;
        }
        
        .friday-notification.show {
            transform: translateY(0);
        }
        
        /* AZAN OVERLAY */
        .azan-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
            color: white;
            text-align: center;
        }
        
        .azan-overlay.show {
            display: flex;
        }
        
        .azan-overlay h1 {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .azan-countdown {
            font-size: 8rem;
            font-weight: 800;
            margin: 20px 0;
        }
        
        /* LOADING */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255,255,255,0.2);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- LOADING -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>
    
    <!-- FRIDAY NOTIFICATION -->
    <div class="friday-notification" id="friday-notification">
        <i class="fas fa-star"></i> MODE JUMAT AKTIF <i class="fas fa-star"></i>
    </div>
    
    <!-- AZAN OVERLAY -->
    <div class="azan-overlay" id="azan-overlay">
        <h1 id="azan-title">MENUJU AZAN</h1>
        <div class="azan-countdown" id="azan-countdown">30</div>
        <div id="azan-prayer-name" style="font-size: 2.5rem; font-weight: 700;">MAGHRIB</div>
    </div>
    
    <!-- HEADER -->
    <header class="header">
        <div class="date-section">
            <div class="hijri-date" id="hijri-date">Loading...</div>
            <div class="gregorian-date" id="gregorian-date">Loading...</div>
        </div>
        
        <div class="masjid-section">
            <h1 class="masjid-name" id="masjid-name">Loading...</h1>
            <p class="masjid-address" id="masjid-address">Loading...</p>
        </div>
    </header>
    
    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <div class="sidebar-left">
            <div class="clock-section">
                <div class="digital-clock" id="digital-clock">00:00</div>
                <div class="timezone" id="timezone">WIB</div>
            </div>
            
            <div class="wisdom-section">
                <div class="wisdom-text" id="wisdom-text">Loading konten hikmah...</div>
                <div class="wisdom-reference" id="wisdom-reference">Loading...</div>
            </div>
        </div>
        
        <div class="wallpaper-section">
            <div class="wallpaper-slider" id="wallpaper-slider">
                <!-- Wallpapers will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- PRAYER SCHEDULE -->
    <footer class="prayer-schedule">
        <div class="schedule-title" id="schedule-title">JADWAL SHALAT HARI INI</div>
        <div class="prayer-grid" id="prayer-grid">
            <div class="prayer-item">
                <div class="prayer-name">Subuh</div>
                <div class="prayer-time" id="fajr-time">--:--</div>
            </div>
            <div class="prayer-item">
                <div class="prayer-name">Syuruq</div>
                <div class="prayer-time" id="sunrise-time">--:--</div>
            </div>
            <div class="prayer-item">
                <div class="prayer-name" id="dhuhr-name">Dzuhur</div>
                <div class="prayer-time" id="dhuhr-time">--:--</div>
            </div>
            <div class="prayer-item">
                <div class="prayer-name">Ashar</div>
                <div class="prayer-time" id="asr-time">--:--</div>
            </div>
            <div class="prayer-item">
                <div class="prayer-name">Maghrib</div>
                <div class="prayer-time" id="maghrib-time">--:--</div>
            </div>
            <div class="prayer-item">
                <div class="prayer-name">Isya</div>
                <div class="prayer-time" id="isha-time">--:--</div>
            </div>
        </div>
    </footer>
    
    <!-- MARQUEE -->
    <div class="marquee-container">
        <div class="marquee-track" id="marquee-track">
            <div class="adab-item"><i class="fas fa-mosque"></i> Loading adab Islam...</div>
        </div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbymSPcmpQWApXl5-f1HVVqPK1O-PM1klMi2rH1wqEUIcVKwAY8yY9YO8URhDjpiqoHP-g/exec';
        
        let configData = {};
        let prayerTimesData = {};
        let wisdomsData = [];
        let fridayWisdomsData = [];
        let adabsData = [];
        let wallpapersData = [];
        
        let currentMode = 'normal';
        let wisdomIndex = 0;
        let wallpaperIndex = 0;
        
        // ========================================
        // FETCH DATA
        // ========================================
        async function fetchAllData() {
            try {
                console.log('üîÑ Fetching all data from API...');
                
                // Fetch config
                const configRes = await fetch(`${API_URL}?path=config`);
                const configResult = await configRes.json();
                
                if (configResult.success) {
                    // Convert array to object
                    configData = {};
                    configResult.data.forEach(item => {
                        configData[item.key] = item.value;
                    });
                    
                    document.getElementById('masjid-name').textContent = configData.masjid_name || 'Masjid';
                    document.getElementById('masjid-address').textContent = configData.masjid_address || '';
                }
                
                // Fetch wisdoms
                const wisdomsRes = await fetch(`${API_URL}?path=wisdoms`);
                const wisdomsResult = await wisdomsRes.json();
                
                if (wisdomsResult.success) {
                    wisdomsData = wisdomsResult.data.filter(w => w.active);
                }
                
                // Fetch friday wisdoms
                const fridayRes = await fetch(`${API_URL}?path=friday-wisdoms`);
                const fridayResult = await fridayRes.json();
                
                if (fridayResult.success) {
                    fridayWisdomsData = fridayResult.data.filter(w => w.active);
                }
                
                // Fetch adabs
                const adabsRes = await fetch(`${API_URL}?path=adabs`);
                const adabsResult = await adabsRes.json();
                
                if (adabsResult.success) {
                    adabsData = adabsResult.data.filter(a => a.active);
                    createAdabMarquee();
                }
                
                // Fetch wallpapers
                const wallpapersRes = await fetch(`${API_URL}?path=wallpapers`);
                const wallpapersResult = await wallpapersRes.json();
                
                if (wallpapersResult.success) {
                    wallpapersData = wallpapersResult.data
                        .filter(w => w.active)
                        .sort((a, b) => a.order - b.order);
                    renderWallpapers();
                }
                
                console.log('‚úÖ All data loaded successfully!');
                
            } catch (error) {
                console.error('‚ùå Error fetching data:', error);
            }
        }
        
        // ========================================
        // PRAYER TIMES
        // ========================================
        async function fetchPrayerTimes() {
            try {
                const latitude = configData.latitude || '-6.5891';
                const longitude = configData.longitude || '106.7930';
                
                const url = `${API_URL}?path=prayer-times&lat=${latitude}&lng=${longitude}`;
                console.log('üïã Fetching prayer times:', url);
                
                const response = await fetch(url);
                const result = await response.json();
                console.log('üì¶ Prayer times response:', result);
                
                if (result.success && result.data) {
                    const data = result.data;
                    console.log('‚úÖ Prayer data:', data);
                    
                    // Update prayer times - handle both direct and nested timings
                    const timings = data.timings || data;
                    console.log('‚è∞ Timings:', timings);
                    
                    if (timings.Fajr) {
                        document.getElementById('fajr-time').textContent = timings.Fajr;
                        document.getElementById('sunrise-time').textContent = timings.Sunrise || '--:--';
                        document.getElementById('dhuhr-time').textContent = timings.Dhuhr || '--:--';
                        document.getElementById('asr-time').textContent = timings.Asr || '--:--';
                        document.getElementById('maghrib-time').textContent = timings.Maghrib || '--:--';
                        document.getElementById('isha-time').textContent = timings.Isha || '--:--';
                        
                        // Store prayer times
                        prayerTimesData = {
                            Fajr: timings.Fajr,
                            Sunrise: timings.Sunrise,
                            Dhuhr: timings.Dhuhr,
                            Asr: timings.Asr,
                            Maghrib: timings.Maghrib,
                            Isha: timings.Isha
                        };
                        
                        console.log('‚úÖ Prayer times stored:', prayerTimesData);
                    } else {
                        console.error('‚ùå No Fajr time found in timings');
                    }
                    
                    // Update hijri date - use backend-provided hijri_formatted if available
                    if (data.hijri_formatted) {
                        document.getElementById('hijri-date').textContent = data.hijri_formatted;
                        console.log('‚úÖ Hijri date (from backend):', data.hijri_formatted);
                    } else if (data.date && data.date.hijri) {
                        // Fallback: construct from date object
                        const hijri = data.date.hijri;
                        const hijriDate = `${hijri.day} ${hijri.month.en} ${hijri.year} H`;
                        document.getElementById('hijri-date').textContent = hijriDate;
                        console.log('‚úÖ Hijri date (constructed):', hijriDate);
                    }
                    
                    // Update gregorian date
                    if (data.date && data.date.gregorian) {
                        const gregorian = data.date.gregorian;
                        const dayNames = {
                            "Monday": "Senin", "Tuesday": "Selasa", "Wednesday": "Rabu",
                            "Thursday": "Kamis", "Friday": "Jumat", "Saturday": "Sabtu", "Sunday": "Minggu"
                        };
                        const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", 
                                           "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
                        
                        const dayName = dayNames[gregorian.weekday.en] || "Hari";
                        const monthIndex = parseInt(gregorian.month.number) - 1;
                        const gregorianDate = `${dayName}, ${parseInt(gregorian.day)} ${monthNames[monthIndex]} ${gregorian.year}`;
                        
                        document.getElementById('gregorian-date').textContent = gregorianDate;
                        console.log('‚úÖ Gregorian date:', gregorianDate);
                    }
                    
                    console.log('‚úÖ Prayer times loaded successfully!');
                } else {
                    console.error('‚ùå Failed to load prayer times:', result);
                    // Set fallback times
                    document.getElementById('fajr-time').textContent = '04:30';
                    document.getElementById('sunrise-time').textContent = '05:45';
                    document.getElementById('dhuhr-time').textContent = '11:59';
                    document.getElementById('asr-time').textContent = '15:15';
                    document.getElementById('maghrib-time').textContent = '18:00';
                    document.getElementById('isha-time').textContent = '19:15';
                    
                    document.getElementById('hijri-date').textContent = 'Tanggal Hijriah';
                    document.getElementById('gregorian-date').textContent = new Date().toLocaleDateString('id-ID', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    console.warn('‚ö†Ô∏è Using fallback prayer times');
                }
                
            } catch (error) {
                console.error('‚ùå Error fetching prayer times:', error);
                console.error('Stack:', error.stack);
                
                // Set fallback on error
                document.getElementById('fajr-time').textContent = '04:30';
                document.getElementById('sunrise-time').textContent = '05:45';
                document.getElementById('dhuhr-time').textContent = '11:59';
                document.getElementById('asr-time').textContent = '15:15';
                document.getElementById('maghrib-time').textContent = '18:00';
                document.getElementById('isha-time').textContent = '19:15';
            }
        }
        
        // ========================================
        // RENDER FUNCTIONS
        // ========================================
        function renderWallpapers() {
            const container = document.getElementById('wallpaper-slider');
            container.innerHTML = '';
            
            if (wallpapersData.length === 0) {
                console.warn('‚ö†Ô∏è No wallpapers data');
                return;
            }
            
            wallpapersData.forEach((wallpaper, index) => {
                const slide = document.createElement('div');
                slide.className = `wallpaper-slide ${index === 0 ? 'active' : ''}`;
                slide.style.backgroundImage = `url('${wallpaper.image_url}')`;
                container.appendChild(slide);
            });
            
            console.log('üñºÔ∏è Rendered', wallpapersData.length, 'wallpapers');
        }
        
        function createAdabMarquee() {
            const marqueeTrack = document.getElementById('marquee-track');
            marqueeTrack.innerHTML = '';
            
            if (adabsData.length === 0) {
                marqueeTrack.innerHTML = '<div class="adab-item"><i class="fas fa-mosque"></i> Selamat datang di Masjid</div>';
                return;
            }
            
            const sortedAdabs = adabsData.sort((a, b) => a.order - b.order);
            
            // Duplicate for seamless loop
            for (let i = 0; i < 2; i++) {
                sortedAdabs.forEach((adab) => {
                    const adabItem = document.createElement('div');
                    adabItem.className = 'adab-item';
                    adabItem.innerHTML = `<i class="${adab.icon}"></i> ${adab.text}`;
                    marqueeTrack.appendChild(adabItem);
                });
            }
        }
        
        // ========================================
        // CLOCK UPDATE
        // ========================================
        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            document.getElementById('digital-clock').textContent = `${hours}:${minutes}`;
            
            updateActivePrayer(now);
        }
        
        function updateActivePrayer(now) {
            const currentTime = now.getHours() * 60 + now.getMinutes();
            const prayerItems = document.querySelectorAll('.prayer-item');
            
            prayerItems.forEach(item => item.classList.remove('active'));
            
            // Simple active prayer logic
            const prayers = ['Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            
            for (let i = 0; i < prayers.length; i++) {
                const prayerTime = prayerTimesData[prayers[i]];
                if (!prayerTime) continue;
                
                const [hour, minute] = prayerTime.split(':').map(Number);
                const prayerMinutes = hour * 60 + minute;
                
                if (i < prayers.length - 1) {
                    const nextPrayerTime = prayerTimesData[prayers[i + 1]];
                    if (nextPrayerTime) {
                        const [nextHour, nextMinute] = nextPrayerTime.split(':').map(Number);
                        const nextPrayerMinutes = nextHour * 60 + nextMinute;
                        
                        if (currentTime >= prayerMinutes && currentTime < nextPrayerMinutes) {
                            prayerItems[i + 1].classList.add('active');
                            break;
                        }
                    }
                }
            }
        }
        
        // ========================================
        // WISDOM ROTATION
        // ========================================
        function rotateWisdom() {
            if (wisdomsData.length === 0) return;
            
            const now = new Date();
            const dayOfWeek = now.getDay();
            const dayMap = {
                0: 'sunday', 1: 'monday', 2: 'tuesday', 3: 'wednesday',
                4: 'thursday', 5: 'friday', 6: 'saturday'
            };
            
            const todayWisdoms = wisdomsData.filter(w => w.day === dayMap[dayOfWeek]);
            
            if (todayWisdoms.length === 0) return;
            
            wisdomIndex = (wisdomIndex + 1) % todayWisdoms.length;
            const wisdom = todayWisdoms[wisdomIndex];
            
            document.getElementById('wisdom-text').textContent = wisdom.text;
            document.getElementById('wisdom-reference').textContent = wisdom.reference;
        }
        
        // ========================================
        // WALLPAPER ROTATION
        // ========================================
        function rotateWallpaper() {
            const wallpapers = document.querySelectorAll('.wallpaper-slide');
            if (wallpapers.length === 0) return;
            
            wallpapers.forEach(w => w.classList.remove('active'));
            
            wallpaperIndex = (wallpaperIndex + 1) % wallpapers.length;
            wallpapers[wallpaperIndex].classList.add('active');
        }
        
        // ========================================
        // FRIDAY MODE
        // ========================================
        function checkFridayMode() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const currentHour = now.getHours();
            
            const fridayStartHour = parseInt(configData.friday_start_hour) || 8;
            const fridayEndHour = parseInt(configData.friday_end_hour) || 14;
            
            if (dayOfWeek === 5 && currentHour >= fridayStartHour && currentHour < fridayEndHour) {
                activateFridayMode();
            } else {
                deactivateFridayMode();
            }
        }
        
        function activateFridayMode() {
            if (currentMode === 'friday') return;
            
            currentMode = 'friday';
            document.body.classList.add('friday-mode');
            document.getElementById('friday-notification').classList.add('show');
            document.getElementById('schedule-title').textContent = 'JADWAL SHALAT JUMAT';
            document.getElementById('dhuhr-name').textContent = 'Jumat';
            
            console.log('üïå Friday mode activated');
        }
        
        function deactivateFridayMode() {
            if (currentMode !== 'friday') return;
            
            currentMode = 'normal';
            document.body.classList.remove('friday-mode');
            document.getElementById('friday-notification').classList.remove('show');
            document.getElementById('schedule-title').textContent = 'JADWAL SHALAT HARI INI';
            document.getElementById('dhuhr-name').textContent = 'Dzuhur';
            
            console.log('üìÖ Normal mode activated');
        }
        
        // ========================================
        // INITIALIZATION
        // ========================================
        async function initialize() {
            console.log('üöÄ Starting Display Digital Masjid...');
            
            try {
                await fetchAllData();
                await fetchPrayerTimes();
                
                // Initialize first wisdom
                rotateWisdom();
                
                // Start timers
                updateClock();
                setInterval(updateClock, 1000);
                
                // Rotations
                setInterval(rotateWisdom, (parseInt(configData.wisdom_duration) || 60) * 1000);
                setInterval(rotateWallpaper, (parseInt(configData.wallpaper_duration) || 30) * 1000);
                setInterval(checkFridayMode, 60000);
                
                // Hide loading
                document.getElementById('loading').classList.add('hidden');
                
                console.log('‚úÖ Display initialized successfully!');
                
            } catch (error) {
                console.error('‚ùå Initialization error:', error);
            }
        }
        
        // Start when DOM is ready
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
